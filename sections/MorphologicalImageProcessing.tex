\section{Morphological Image Processing\buch{Ch. 9}}
\subsection{Set Theory}
\subsubsection{Reflection}
\[
	\hat{B} = \{w | w = -b,\quad \text{for} \quad b \in B \}
\]


\subsubsection{Translation}
\[
	(B)_z = \{ c | c = b + z,\quad \text{for} \quad b \in B\}
\]


\subsubsection{Erosion}
With A and B as sets in $Z^2$, the erosion of A by B is defined as
\[
	A \ominus B = \{z|(B)_z \subseteq A  \}
\]

This is the set of all translations by z such that the set B is still a subset of A.

Equivalently, if B must be contained in A, it is not allowed to intersect with the background:
\[
	A \ominus B = \{z|(B)_z \cap A^c = \varnothing  \}
\]


\subsubsection{Dilation}
With A and B as sets in $Z^2$, the dilation of A by B is defined as
\[
	A \oplus B = \{z |(\hat{B})_z \cap A \neq \varnothing \}
\]
This is the set of all translations by z such that the set B reflected about its origin has at leas one overlap with the set A.

Equivalently, since the intersection is not allowed to be empty and all elements in it must be from A:
\[
	A \oplus B = \{z | [(\hat{B})_z \cap A] \subseteq A \}
\]


\subsubsection{Duality erosion/dilation}
Erosion and dilation are dual:
\[
	(A  \ominus B)^c = A^c \oplus \hat{B}
\]
\[
	(A \oplus B)^c = A^c \ominus \hat{B}
\]


\subsubsection{Opening and closing}
The opening of A by B is defined: (first erosion then dilation)
\[
	A \circ B = (A \ominus B) \oplus B
\]

The closing of A by B is defined: (first dilation then erosion)
\[
	A  \bullet B = (A \oplus B) \ominus B
\]

Opening and closing are dual operations: 
\[
	(A  \bullet B)^c = (A^c \circ \hat{B})
\]
\[
	(A \circ B)^c = (A^c \bullet \hat{B})
\]

\begin{figure}
	\centering
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\adjustbox{scale=0.5}{\input{tikz/erosionanddilation/rolling_circle}}
		\caption{Opening}
	\end{subfigure}
	\begin{subfigure}[b]{0.45\textwidth}
		\centering
		\adjustbox{scale=0.5}{\input{tikz/erosionanddilation/rolling_circle_closing}}
		\caption{Closing}
	\end{subfigure}
	\caption{Geometrical interpretation of the opening and closing transformations}
\end{figure}


\subsubsection{The hit-or-miss transform}
The hit-or-miss transform is a basic tool for shape detection. Basic idea:
\begin{itemize}
	\item Through erosion of the image by the object, possible locations for the object in the image are left, since elements smaller than the objects disappear
	
	\item Through erosion of the background of the image with the local background of the object, possible locations for the object in the image are left
	
	\item The intersection of these possible locations result in a reliable  detection of the object location
	\[
		A \circledast B = (A \ominus D) \cap [ A^c \ominus (W-D)]
	\]
	
	\item In general, if B1 is the object and B2 is the corresponding background this can be written
	\[
		A \circledast B = (A \ominus B_1)\cap (A^c \ominus B_2)	
	\]	
\end{itemize}

\subsection{Some basic morphological algorithms}
\subsubsection{Convex hull}
\begin{itemize}
\item The convex hull H of a set S is the smalles convex set containing S.
\item H-S is called the convex deficiency of S
\end{itemize}
The convex hull is constructed with a convex hull with four structuring elements.
%TODO Image page 26
The resulting set is not the smallest convex set that contains A. The following additional constraints can be used:
\begin{itemize}
\item The convex hull is not allowed to grow beyond the original vertical and horizontal dimension
\item 
\end{itemize}

\subsubsection{Thinning}
Thinning is the operation of making the foreground thinner.
%TODO Image page 29
	\[
		A \otimes  B = A - (A \circledast B)	
	\]	
Hit or miss transformation with rotating structuring elements.\\

%TODO Image 8 structuring elements page 31
	\[
		A \otimes  {B} = ((\ldots((A \otimes B^{1}) \otimes B^{2})\ldots) \otimes B^{n})	
	\]	

\subsubsection{Thickening}
This is the morphological dual of thinning. It is implemented as thinning the background and then taking the complement.

\subsubsection{Skeleton S(A)}
%TODO Image page 33
Finding a disk D that:
\begin{itemize}
\item centers at z
\item there is no larger disk containing D and included in A
\item touches the boundary of A at two or more places
\end{itemize}
	\[
		S(A) = \bigcup_{k=0}^{K} S_k(A)
	\]
with
	\[
		S_k(A) = (A \ominus kB) - (A \ominus kB) \circ B
	\]
	
\subsubsection{Pruning}
Pruning is a procedure that can remove parasitic components of a length below some threshold.\\
\begin{enumerate}
\item Find endpoints with a hit or miss transform with the following structuring elements. Remove the endpoints.
%TODO 2 structuring elements page 36
\item Repeat this. If you want to remove all spurs of length 3 or less, repeat for 3 times
\item Find the endpoints using the same structuring elements
\item Dilate the endpoints with a 3x3 structuring element and make a logical and with the original set
\end{enumerate}

\subsubsection{Geodesic dilation and erosion}
This is a transformation which uses two images and a structuring element
\begin{itemize}
\item F is the marker image
\item G is the mask image
\item Both are binary and F is a subset of G
\end{itemize}
\textbf{Geodesic dilation}
\[
	D_G^{(1)}(F) = (F\oplus B)\cup G
\]
Can be repeated:
\begin{align*}
	D_G^{(0)}(F) = F \\
	D_G^{(1)}(F) = (F\oplus B)\cup G\\
	D_G^{(n)}(F) = D_G^{(1)}[D_G^{(n-1)}(F)]
\end{align*}

\textbf{Geodesic erosion}
\[
	E_G^{(1)}(F) = (F\ominus B)\cap G
\]

\subsubsection{Morphological reconstruction}
This is geodesic dilation/erosion until nothing changes.

\subsubsection{Sample applications}
\textbf{Opening and closing by reconstruction}\\
Opening by reconstruction removes all small object, all others stay unchanged.
Closing by reconstruction closes gaps, the rest is unchanged. This is in contrast to morphological opening and closing, where the erosion removes the small objects and the dilation "sort of" reconstructs the other objects.\\

\textbf{Filling holes in a binary image I}\\
Without needing a seed!\\
\[
	H = [R_F^D(F)]^C
\]
%TODO image series page 48

\textbf{Boder clearing}\\
Remove object that touch the border.